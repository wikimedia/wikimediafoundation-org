jQuery(document).ready(function(J){"use strict";J(".d3-dataprofiles").each(function(){!function(v){var t=J("#"+v),w=10,A=d3.format(","),b=t.width(),k={x:b<380?b/2-w:190,y:125},j=t.data("max-feature-1")?t.data("max-feature-1"):90,M=t.data("max-feature-2")?t.data("max-feature-2"):90,r=Math.max(Math.floor(b/k.x),2),B=J("body").width(),L=190*r,P=500,R=t.data("chart-masterunit")?t.data("chart-masterunit"):5e5,F=b<L?24:30,z=t.data("chart-raw"),C=t.data("slice-start"),S=t.data("slice-end"),Y=t.data("chart-labels"),I=45,O=t.data("chart-icons"),Q=t.data("chart-except"),T=Q?z[Y[0]]:"",q=3.5,D=Q?k.y*q:E(null,S-C-1)+k.y;function E(t,a){var e=6*w;return(Q?0:5*w)+(k.y+e)*Math.floor(a/r)}function G(t,a){return a%r*k.x}function H(t,a,e,r){return parseFloat(t.selectAll(a).nodes()[e].getAttribute(r))}!function(){if(z){var t,e,r,n,l,a=d3.select("#"+v),f=[J("#feature1"),J("#feature2"),J("#feature3")],i=b/D,c=z.map(function(t,a){var e=Math.floor(t[Y[3]]/R),r=t[Y[3]]%R,n=0===a?F:5,l=Math.ceil(e/n);t.unitArray=[];for(var i=0;i<l;i++)for(var c=0;c<n;c++)t.unitArray.push({x:c,y:i,value:R});return t.unitArray=t.unitArray.slice(0,e),t.unitArray[t.unitArray.length-1].value=r,t.Rows=l,t}),p=c.slice(C,S),o=d3.max(c,function(t){return t.Rows}),u=d3.scaleLinear().domain([0,d3.max(z,function(t){return t[Y[1]]})]).range([0,j]),s=d3.scaleLinear().domain([0,d3.max(z,function(t){return t[Y[2]]})]).range([0,M]),m=d3.scaleLinear().domain([0,R]).range([0,4]),d=d3.scaleLinear().domain([0,o]).range([0,4*o*2]),h=d3.scaleLinear().domain([0,5]).range([0,50]),x=2*u.range()[1]+d.range()[1]+4*(I+w);q=(D=Q&&D<x?x:D)/k.y,t=a.append("svg").attr("width",b).attr("height",D).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+b+" "+D),J(window).resize(function(){var t=a.node().getBoundingClientRect().width;a.selectAll("svg").attr("width",t),a.selectAll("svg").attr("height",t/i)}),e=t.append("g").call(function(t){return t.attr("transform","translate("+w+","+w+")").attr("class","profile-feature1").selectAll("circle").data(p).join("circle").attr("cx",function(t,a){return Q?G(0,a)+Math.max(b/4,u(t[Y[1]])+w):G(0,a)+u(t[Y[1]])}).attr("cy",function(t,a){return E(0,a)+u(t[Y[1]])}).attr("r",function(t){return u(t[Y[1]])})}),r=t.append("g").call(function(t,i){return t.attr("transform","translate("+w+","+w+")").attr("class","profile-feature2").selectAll("rect").data(p).join("rect").attr("x",function(t,a){var e=H(i,"circle",a,"cx")+H(i,"circle",a,"r")+w/2,r=.4*b+(b/2-.75*s(t[Y[2]]))/2,n=Q?r:e,l=H(i,"circle",a,"cx")+H(i,"circle",a,"r")+3*w;return b<L&&Q?l:n}).attr("y",function(t,a){return E(0,a)}).attr("width",function(t){return.75*s(t[Y[2]])}).attr("height",function(t){return s(t[Y[2]])}).attr("rx",function(t){return.08*s(t[Y[2]])}).attr("ry",function(t){return.08*s(t[Y[2]])})},e),n=t.append("g").call(function(t,a,e){t.attr("class","profile-feature3");for(var r=0;r<p.length;r++){var n=m(R)/3*2,l=H(e,"rect",r,"x")+H(e,"rect",r,"width")+w,i=H(e,"rect",r,"y")+n,c=(b-h(F))/2,o=H(a,"circle",r,"cx")+H(a,"circle",r,"r")+I+2*w,u=Q?c:l,s=Q?o:i;t.append("g").attr("class","viewsContainer").attr("transform","translate("+w+","+w+")").selectAll("ellipse").data(p[r].unitArray).join("ellipse").attr("class","views-"+r).attr("cx",function(t){return u+h(t.x)}).attr("cy",function(t){return s+d(t.y)}).attr("rx",function(t){return m(t.value)}).attr("ry",function(t){return m(t.value)/3*2})}return t},e,r),t.append("g").call(function(t,a,e){var r=Q?w*q+w:2*w,n=Q?D-w:.75*k.y+w;return t.call(function(t){return t.append("g").attr("class","main-labels").selectAll("text").data(p).join("text").attr("text-anchor","start").attr("dy",-5).attr("x",function(t,a){return B<P?G(0,a)+w:G(0,a)+r}).attr("y",function(t,a){return E(0,a)+n}).text(function(t){return 4<Y.length?t[Y[4]]:t[Y[0]]})}).call(function(t){return t.append("g").attr("class","main-label-ranks").style("display","none").selectAll("text").data(p).join("text").attr("text-anchor","start").attr("dy",-30).attr("x",function(t,a){return B<P?G(0,a)+w:G(0,a)+r}).attr("y",function(t,a){return E(0,a)+n}).text(function(t,a){return a+1+e})})},e,C),t.append("g").call(function(t){var e=Q?D:k.y-w,r=Q?w*q:w;return t.attr("stroke-width",2).attr("class","borderleft").selectAll("line").data(p).join("line").attr("x1",function(t,a){return G(0,a)+2}).attr("x2",function(t,a){return B<P?G(0,a)+2:G(0,a)+r}).attr("y1",function(t,a){return E(0,a)}).attr("y2",function(t,a){return E(0,a)+e})}),Q?t.append("g").call(function(t,a,e,r){var n,l,i=p[0],c=H(e,"rect",0,"x"),o=H(e,"rect",0,"y"),u=H(e,"rect",0,"width"),s=H(e,"rect",0,"height"),d=H(r,"ellipse",F-1,"cx"),f=H(r,"ellipse",Math.floor(F/2)-1,"cx"),h=H(r,"ellipse",F*(i.Rows-1),"cy"),x=F*i.Rows%i.unitArray.length>Math.ceil(F/2)+1,y=[{x:H(a,"circle",0,"cx"),y:H(a,"circle",0,"cy")+H(a,"circle",0,"r")-w,y2:D-60,h:I,class:1,highlight:!0,name:[A(i[Y[1]])+" "+Y[1]]},{x:c+.5*u,y:o+s-w,y2:D-60,h:I,class:2,highlight:!0,name:[A(i[Y[2]])+" "+Y[2]]},{x:f,y:x?h:h+w,y2:D-90,h:I,class:3,highlight:!0,name:[A(i[Y[3]])+" "+Y[3]]},{x:d,y:h-2*m.range()[1],y2:D-120,h:I/2,class:3,highlight:!1,name:[A(R),Y[3]]}];return t.append("g").attr("transform","translate("+w+","+w+")").attr("class","data-label-lines").selectAll("line").data(y).join("line").attr("class",function(t){return"profile-feature"+t.class}).attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y}).attr("y2",function(t){return t.y+t.h}).attr("stroke-dasharray",function(t){return t.highlight?"":w/3+","+w/4}),(n=t.append("g").attr("transform","translate("+w+","+w+")").attr("class","data-label-text").selectAll("text").data(y).join("text").attr("class",function(t){return"profile-feature"+t.class}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y+t.h}).attr("dy",1.5*w).attr("stroke-width",0).attr("font-weight",function(t){return t.highlight?"bold":"normal"}).attr("text-anchor","middle")).append("tspan").attr("x",function(t){return t.x}).attr("dx",m.range()[1]).text(function(t){return t.name[0]}),n.append("tspan").attr("x",function(t){return t.x}).attr("dy",16).attr("dx",m.range()[1]).text(function(t){return t.name[1]}),l=t.append("g").attr("transform","translate("+w+","+w+")").attr("class","data-label-icon"),n.selectAll("tspan").each(function(a,t){if(0===t&&a.highlight){var e=this.getBBox().width;l.call(function(t){return t.append("image").attr("class","profile-feature"+a.class).attr("xlink:href",O[a.class-1]).attr("width",1.1*w).attr("height",1.1*w).attr("x",a.x-e/2-w).attr("y",a.y+a.h+.5*w)})}}),t},e,r,n):(l=t.append("g").attr("class","tooltip"),t.append("g").attr("opacity",0).attr("class","tooltipgrid").selectAll("rect").data(p).join("rect").attr("class","hover").attr("x",function(t,a){return G(0,a)}).attr("y",function(t,a){return E(0,a)}).attr("width",k.x).attr("height",k.y).on("touchstart mouseover",function(t,a){p[a][Y[0]]!==T&&l.call(y,a,e,r,n)}).on("touchend mouseout",function(){l.call(y,null)}),J(".chart-options input[type='checkbox']").click(g),g())}function y(t,a,e,r,n){if(null===a)return t.transition().attr("opacity",0).transition().style("display","none");var l=H(e,"circle",a,"cx"),i=H(r,"rect",a,"x"),c=H(r,"rect",a,"width"),o=H(n,".views-"+a,Math.min(Math.floor(2.5),p[a].unitArray.length-1),"cx")+w,u=w,s=b<L?20:0,d=[{value:p[a][Y[1]],x:Math.round(l+w),y1:E(0,a)+w,h:36,labelPos:[l,E(0,a)-36]},{value:p[a][Y[2]],x:Math.round(i+w+c/2),y1:E(0,a)+w,h:21,labelPos:[i+c/2,E(0,a)-21]},{value:p[a][Y[3]],x:Math.round(o),y1:E(0,a)+2*m.range()[1],h:6,labelPos:[o-w-s,E(0,a)-6]}];return t.transition().attr("opacity",1).style("display",null).style("pointer-events","none"),t.selectAll("line").data(d).join("line").attr("class","hover-label-lines").attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y1}).attr("y2",function(t){return t.y1-t.h}).style("display",function(t,a){return f[a].is(":checked")?"block":"none"}),t.selectAll("text").data(d).join("text").attr("x",function(t){return t.labelPos[0]}).attr("y",function(t){return t.labelPos[1]}).attr("dy",.5*w).attr("dx",1.8*w).text(function(t){return A(t.value)}).style("display",function(t,a){return f[a].is(":checked")?"block":"none"}),4<Y.length&&t.append("text").attr("x",B<P?G(0,a):G(0,a)+w).attr("y",E(0,a)+k.y).attr("dy",-w).attr("dx",w).text(p[a][Y[0]]),t.selectAll("image").data(d).join("image").attr("xlink:href",function(t,a){return O[a]}).attr("width",u).attr("height",u).attr("x",function(t){return t.labelPos[0]+.5*w}).attr("y",function(t){return t.labelPos[1]-.5*u}).style("display",function(t,a){return f[a].is(":checked")?"block":"none"}),t}function g(){for(var t=0;t<f.length;t++){var a=J(".profile-feature"+(t+1));f[t].is(":checked")?a.fadeIn():a.fadeOut()}f[0].is(":checked")||f[1].is(":checked")||f[2].is(":checked")?J(".main-label-ranks").fadeOut():J(".main-label-ranks").fadeIn()}}()}(this.id)})}),jQuery(document).ready(function(w){"use strict";function t(c){var t=w("#"+c),o=w(window).width()<762,u=30,a=o?20:60,e=60,s=40,d=t.width(),f=d-s-a,h=300-u-e,x=1.5,y=4,p=t.data("stroke-color"),m="month"===t.data("time-format")?{month:"long"}:{month:"short",day:"numeric",year:"numeric"},r=d3.timeParse("%Y-%m-%d"),n=t.data("chart-raw"),g=n?n.map(function(t){return t.date=r(t.date),t}):null;function v(t,a,e,r){if(!a)return t.style("display","none");t.attr("class","tooltip").style("display",null).style("pointer-events","none");var n=t.selectAll("rect").data([null]).join("rect").attr("rx",2).attr("ry",2),l=t.selectAll("text").data([null]).join("text").call(function(t){return t.selectAll("tspan").data(a.split(/\n/)).join("tspan").attr("x",0).attr("y",function(t,a){return 1.2*a+"em"}).style("font-weight",function(t,a){return a?null:"bold"}).text(function(t){return t})}),i=l.node().getBBox(),c=i.width,o=i.height;return t.selectAll("circle").data([null]).join("circle").attr("r",y).attr("stroke-width",x).attr("fill",r?"none":"white"),n.attr("width",c+20).attr("height",o+20),f<e+c?(l.attr("transform","translate("+(-c-20)+","+-((o-20)/2-2)+")"),n.attr("x",-(c+10+20)).attr("y",-(o+20)/2)):(l.attr("transform","translate(20,"+-((o-20)/2-2)+")"),n.attr("x",10).attr("y",-(o+20)/2)),t}!function(){if(g){var t,e,a=4,i=d3.scaleTime().nice().domain(d3.extent(g,function(t){return t.date})).range([0,f]),r=d3.scaleLinear().domain([0,d3.max(g,function(t){return t.value})]).range([h,0]),n=d3.select("#"+c),l=d/300;t=n.append("svg").attr("width",d).attr("height",300).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+d+" 300").append("g").attr("transform","translate("+s+","+u+")"),w(window).resize(function(){var t=n.node().getBoundingClientRect().width;n.selectAll("svg").attr("width",t),n.selectAll("svg").attr("height",t/l)}),t.append("g").call(function(t){t.attr("transform","translate(0,"+h+")").call(d3.axisBottom(i).ticks(d3.timeMonth,1).tickFormat(o?d3.timeFormat("%b"):d3.timeFormat("%B"))).call(function(t){t.select(".domain").remove()})}),t.append("g").call(function(t){t.attr("class","yAxis").call(d3.axisLeft(r).ticks(a).tickFormat(d3.format(".2s")).tickSize(-1*f)).call(function(t){t.select(".domain").remove()})}),t.append("path").datum(g).attr("fill","none").attr("stroke-width",x).attr("stroke","black").attr("class","line "+p).attr("d",d3.line().x(function(t){return i(t.date)}).y(function(t){return r(t.value)})),t.append("g").selectAll("circle").data(g.filter(function(t){return t.event})).enter("circle").append("circle").attr("class","circle "+p).attr("r",y).attr("cx",function(t){return i(t.date)}).attr("cy",function(t){return r(t.value)}),e=t.append("g"),t.append("rect").attr("class","overlay").attr("pointer-events","all").attr("x",0).attr("y",0).attr("width",f).attr("height",h).on("touchmove mousemove",function(){var t=function(t){var a=d3.bisector(function(t){return t.date}).left,e=i.invert(t),r=a(g,e,1),n=g[r-1],l=g[r];return e-n.date>l.date-e?l:n}(d3.mouse(this)[0]),a=t.date.toLocaleString(void 0,m)+"\n"+d3.format(",")(t.value);e.attr("transform","translate("+i(t.date)+","+r(t.value)+")").call(v,a,i(t.date),t.event),t.event?(w("#label-date").text(t.date.toLocaleString(void 0,m)),w("#label-name").text(t.event),w("#linechart-label").css("opacity",1),w("#linechart-label").css("max-height","10rem")):(w("#linechart-label").css("opacity",0),w("#linechart-label").css("max-height","2rem"))}).on("touchend mouseleave",function(){e.call(v,null)})}}()}w(".d3-linechart").each(function(){t(this.id)})});
//# sourceMappingURL=maps/datavis.min.js.map
