jQuery(document).ready(function(G){"use strict";function t(t){var e,r,n,l,a,c,i,f,o,u,h,s,d,x=G("#"+t),y=10,p=d3.format(","),m=x.width(),g={x:m<380?m/2-y:190,y:125},O=x.data("max-feature-1")?x.data("max-feature-1"):90,Q=x.data("max-feature-2")?x.data("max-feature-2"):90,v=Math.max(Math.floor(m/g.x),2),w=G("body").width(),A=190*v,b=500,k=x.data("chart-masterunit")?x.data("chart-masterunit"):5e5,j=m<A?24:30,M=x.data("chart-raw"),B=x.data("slice-start"),L=x.data("slice-end"),P=x.data("chart-labels"),R=45,T=x.data("chart-icons"),F=x.data("chart-except"),q=F?M[P[0]]:"",z=3.5,C=F?g.y*z:S(0,L-B-1)+g.y;function S(t,a){return(F?0:50)+(g.y+60)*Math.floor(a/v)}function Y(t,a){return a%v*g.x}function I(t,a,e,r){return parseFloat(t.selectAll(a).nodes()[e].getAttribute(r))}function D(t,a,e,r,n){if(null===a)return t.transition().attr("opacity",0).transition().style("display","none");var e=I(e,"circle",a,"cx"),l=I(r,"rect",a,"x"),r=I(r,"rect",a,"width"),n=I(n,".views-"+a,Math.min(Math.floor(2.5),f[a].unitArray.length-1),"cx")+y,i=m<A?20:0,e=[{value:f[a][P[1]],x:Math.round(e+y),y1:S(0,a)+y,h:36,labelPos:[e,S(0,a)-36]},{value:f[a][P[2]],x:Math.round(l+y+r/2),y1:S(0,a)+y,h:21,labelPos:[l+r/2,S(0,a)-21]},{value:f[a][P[3]],x:Math.round(n),y1:S(0,a)+2*h.range()[1],h:6,labelPos:[n-y-i,S(0,a)-6]}];return t.transition().attr("opacity",1).style("display",null).style("pointer-events","none"),t.selectAll("line").data(e).join("line").attr("class","hover-label-lines").attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y1}).attr("y2",function(t){return t.y1-t.h}).style("display",function(t,a){return c[a].is(":checked")?"block":"none"}),t.selectAll("text").data(e).join("text").attr("x",function(t){return t.labelPos[0]}).attr("y",function(t){return t.labelPos[1]}).attr("dy",5).attr("dx",18).text(function(t){return p(t.value)}).style("display",function(t,a){return c[a].is(":checked")?"block":"none"}),4<P.length&&t.append("text").attr("x",w<b?Y(0,a):Y(0,a)+y).attr("y",S(0,a)+g.y).attr("dy",-y).attr("dx",y).text(f[a][P[0]]),t.selectAll("image").data(e).join("image").attr("xlink:href",function(t,a){return T[a]}).attr("width",10).attr("height",10).attr("x",function(t){return t.labelPos[0]+5}).attr("y",function(t){return t.labelPos[1]-5}).style("display",function(t,a){return c[a].is(":checked")?"block":"none"}),t}function E(){for(var t=0;t<c.length;t++){var a=G(".profile-feature"+(t+1));c[t].is(":checked")?a.fadeIn():a.fadeOut()}c[0].is(":checked")||c[1].is(":checked")||c[2].is(":checked")?G(".main-label-ranks").fadeOut():G(".main-label-ranks").fadeIn()}M&&(a=d3.select("#"+t),c=[G("#feature1"),G("#feature2"),G("#feature3")],i=m/C,x=M.map(function(t,a){var e=Math.floor(t[P[3]]/k),r=t[P[3]]%k,n=0===a?j:5,l=Math.ceil(e/n);t.unitArray=[];for(var i=0;i<l;i++)for(var c=0;c<n;c++)t.unitArray.push({x:c,y:i,value:k});return t.unitArray=t.unitArray.slice(0,e),t.unitArray[t.unitArray.length-1].value=r,t.Rows=l,t}),f=x.slice(B,L),x=d3.max(x,function(t){return t.Rows}),o=d3.scaleLinear().domain([0,d3.max(M,function(t){return t[P[1]]})]).range([0,O]),u=d3.scaleLinear().domain([0,d3.max(M,function(t){return t[P[2]]})]).range([0,Q]),h=d3.scaleLinear().domain([0,k]).range([0,4]),s=d3.scaleLinear().domain([0,x]).range([0,4*x*2]),d=d3.scaleLinear().domain([0,5]).range([0,50]),x=2*o.range()[1]+s.range()[1]+220,z=(C=F&&C<x?x:C)/g.y,x=a.append("svg").attr("width",m).attr("height",C).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+m+" "+C),G(window).resize(function(){var t=a.node().getBoundingClientRect().width;a.selectAll("svg").attr("width",t),a.selectAll("svg").attr("height",t/i)}),e=x.append("g").call(function(t){return t.attr("transform","translate(10,10)").attr("class","profile-feature1").selectAll("circle").data(f).join("circle").attr("cx",function(t,a){return F?Y(0,a)+Math.max(m/4,o(t[P[1]])+y):Y(0,a)+o(t[P[1]])}).attr("cy",function(t,a){return S(0,a)+o(t[P[1]])}).attr("r",function(t){return o(t[P[1]])})}),r=x.append("g").call(function(t,r){return t.attr("transform","translate(10,10)").attr("class","profile-feature2").selectAll("rect").data(f).join("rect").attr("x",function(t,a){var e=I(r,"circle",a,"cx")+I(r,"circle",a,"r")+5,t=.4*m+(m/2-.75*u(t[P[2]]))/2,t=F?t:e,e=I(r,"circle",a,"cx")+I(r,"circle",a,"r")+30;return m<A&&F?e:t}).attr("y",function(t,a){return S(0,a)}).attr("width",function(t){return.75*u(t[P[2]])}).attr("height",function(t){return u(t[P[2]])}).attr("rx",function(t){return.08*u(t[P[2]])}).attr("ry",function(t){return.08*u(t[P[2]])})},e),n=x.append("g").call(function(t,a,e){t.attr("class","profile-feature3");for(var r=0;r<f.length;r++){var n=h(k)/3*2,l=I(e,"rect",r,"x")+I(e,"rect",r,"width")+y,n=I(e,"rect",r,"y")+n,i=(m-d(j))/2,c=I(a,"circle",r,"cx")+I(a,"circle",r,"r")+R+20,o=F?i:l,u=F?c:n;t.append("g").attr("class","viewsContainer").attr("transform","translate(10,10)").selectAll("ellipse").data(f[r].unitArray).join("ellipse").attr("class","views-"+r).attr("cx",function(t){return o+d(t.x)}).attr("cy",function(t){return u+s(t.y)}).attr("rx",function(t){return h(t.value)}).attr("ry",function(t){return h(t.value)/3*2})}return t},e,r),x.append("g").call(function(t,a,e){var r=F?y*z+y:20,n=F?C-y:.75*g.y+y;return t.call(function(t){return t.append("g").attr("class","main-labels").selectAll("text").data(f).join("text").attr("text-anchor","start").attr("dy",-5).attr("x",function(t,a){return w<b?Y(0,a)+y:Y(0,a)+r}).attr("y",function(t,a){return S(0,a)+n}).text(function(t){return 4<P.length?t[P[4]]:t[P[0]]})}).call(function(t){return t.append("g").attr("class","main-label-ranks").style("display","none").selectAll("text").data(f).join("text").attr("text-anchor","start").attr("dy",-30).attr("x",function(t,a){return w<b?Y(0,a)+y:Y(0,a)+r}).attr("y",function(t,a){return S(0,a)+n}).text(function(t,a){return a+1+e})})},e,B),x.append("g").call(function(t){var e=F?C:g.y-y,r=F?y*z:y;return t.attr("stroke-width",2).attr("class","borderleft").selectAll("line").data(f).join("line").attr("x1",function(t,a){return Y(0,a)+2}).attr("x2",function(t,a){return w<b?Y(0,a)+2:Y(0,a)+r}).attr("y1",function(t,a){return S(0,a)}).attr("y2",function(t,a){return S(0,a)+e})}),F?x.append("g").call(function(t,a,e,r){var n,l=f[0],i=I(e,"rect",0,"x"),c=I(e,"rect",0,"y"),o=I(e,"rect",0,"width"),e=I(e,"rect",0,"height"),u=I(r,"ellipse",j-1,"cx"),s=I(r,"ellipse",Math.floor(j/2)-1,"cx"),r=I(r,"ellipse",j*(l.Rows-1),"cy"),d=j*l.Rows%l.unitArray.length>Math.ceil(j/2)+1,a=[{x:I(a,"circle",0,"cx"),y:I(a,"circle",0,"cy")+I(a,"circle",0,"r")-y,y2:C-60,h:R,class:1,highlight:!0,name:[p(l[P[1]])+" "+P[1]]},{x:i+.5*o,y:c+e-y,y2:C-60,h:R,class:2,highlight:!0,name:[p(l[P[2]])+" "+P[2]]},{x:s,y:d?r:r+y,y2:C-90,h:R,class:3,highlight:!0,name:[p(l[P[3]])+" "+P[3]]},{x:u,y:r-2*h.range()[1],y2:C-120,h:R/2,class:3,highlight:!1,name:[p(k),P[3]]}];return t.append("g").attr("transform","translate(10,10)").attr("class","data-label-lines").selectAll("line").data(a).join("line").attr("class",function(t){return"profile-feature"+t.class}).attr("x1",function(t){return t.x}).attr("x2",function(t){return t.x}).attr("y1",function(t){return t.y}).attr("y2",function(t){return t.y+t.h}).attr("stroke-dasharray",function(t){return t.highlight?"":y/3+",2.5"}),(i=t.append("g").attr("transform","translate(10,10)").attr("class","data-label-text").selectAll("text").data(a).join("text").attr("class",function(t){return"profile-feature"+t.class}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y+t.h}).attr("dy",15).attr("stroke-width",0).attr("font-weight",function(t){return t.highlight?"bold":"normal"}).attr("text-anchor","middle")).append("tspan").attr("x",function(t){return t.x}).attr("dx",h.range()[1]).text(function(t){return t.name[0]}),i.append("tspan").attr("x",function(t){return t.x}).attr("dy",16).attr("dx",h.range()[1]).text(function(t){return t.name[1]}),n=t.append("g").attr("transform","translate(10,10)").attr("class","data-label-icon"),i.selectAll("tspan").each(function(a,t){var e;0===t&&a.highlight&&(e=this.getBBox().width,n.call(function(t){return t.append("image").attr("class","profile-feature"+a.class).attr("xlink:href",T[a.class-1]).attr("width",11).attr("height",11).attr("x",a.x-e/2-y).attr("y",a.y+a.h+5)}))}),t},e,r,n):(l=x.append("g").attr("class","tooltip"),x.append("g").attr("opacity",0).attr("class","tooltipgrid").selectAll("rect").data(f).join("rect").attr("class","hover").attr("x",function(t,a){return Y(0,a)}).attr("y",function(t,a){return S(0,a)}).attr("width",g.x).attr("height",g.y).on("touchstart mouseover",function(t,a){f[a][P[0]]!==q&&l.call(D,a,e,r,n)}).on("touchend mouseout",function(){l.call(D,null)}),G(".chart-options input[type='checkbox']").click(E),E()))}G(".d3-dataprofiles").each(function(){t(this.id)})}),jQuery(document).ready(function(w){"use strict";function t(c){var t=w("#"+c),o=w(window).width()<762,u=30,a=o?20:60,e=60,s=40,d=t.width(),f=d-s-a,h=300-u-e,x=1.5,y=4,p=t.data("stroke-color"),m="month"===t.data("time-format")?{month:"long"}:{month:"short",day:"numeric",year:"numeric"},r=d3.timeParse("%Y-%m-%d"),a=t.data("chart-raw"),g=a?a.map(function(t){return t.date=r(t.date),t}):null;function v(t,a,e,r){if(!a)return t.style("display","none");t.attr("class","tooltip").style("display",null).style("pointer-events","none");var n=t.selectAll("rect").data([null]).join("rect").attr("rx",2).attr("ry",2),l=t.selectAll("text").data([null]).join("text").call(function(t){return t.selectAll("tspan").data(a.split(/\n/)).join("tspan").attr("x",0).attr("y",function(t,a){return 1.2*a+"em"}).style("font-weight",function(t,a){return a?null:"bold"}).text(function(t){return t})}),i=l.node().getBBox(),c=i.width,i=i.height;return t.selectAll("circle").data([null]).join("circle").attr("r",y).attr("stroke-width",x).attr("fill",r?"none":"white"),n.attr("width",c+20).attr("height",i+20),f<e+c?(l.attr("transform","translate("+(-c-20)+","+-((i-20)/2-2)+")"),n.attr("x",-(c+10+20)).attr("y",-(i+20)/2)):(l.attr("transform","translate(20,"+-((i-20)/2-2)+")"),n.attr("x",10).attr("y",-(i+20)/2)),t}!function(){var a,r,n,l,e,i,t;g&&(a=4,r=d3.scaleTime().nice().domain(d3.extent(g,function(t){return t.date})).range([0,f]),n=d3.scaleLinear().domain([0,d3.max(g,function(t){return t.value})]).range([h,0]),e=d3.select("#"+c),i=d/300,t=e.append("svg").attr("width",d).attr("height",300).attr("perserveAspectRatio","xMidYMid meet").attr("viewBox","0 0 "+d+" 300").append("g").attr("transform","translate("+s+","+u+")"),w(window).resize(function(){var t=e.node().getBoundingClientRect().width;e.selectAll("svg").attr("width",t),e.selectAll("svg").attr("height",t/i)}),t.append("g").call(function(t){t.attr("transform","translate(0,"+h+")").call(d3.axisBottom(r).ticks(d3.timeMonth,1).tickFormat(o?d3.timeFormat("%b"):d3.timeFormat("%B"))).call(function(t){t.select(".domain").remove()})}),t.append("g").call(function(t){t.attr("class","yAxis").call(d3.axisLeft(n).ticks(a).tickFormat(d3.format(".2s")).tickSize(-1*f)).call(function(t){t.select(".domain").remove()})}),t.append("path").datum(g).attr("fill","none").attr("stroke-width",x).attr("stroke","black").attr("class","line "+p).attr("d",d3.line().x(function(t){return r(t.date)}).y(function(t){return n(t.value)})),t.append("g").selectAll("circle").data(g.filter(function(t){return t.event})).enter("circle").append("circle").attr("class","circle "+p).attr("r",y).attr("cx",function(t){return r(t.date)}).attr("cy",function(t){return n(t.value)}),l=t.append("g"),t.append("rect").attr("class","overlay").attr("pointer-events","all").attr("x",0).attr("y",0).attr("width",f).attr("height",h).on("touchmove mousemove",function(){a=d3.mouse(this)[0],e=d3.bisector(function(t){return t.date}).left,a=r.invert(a),e=e(g,a,1),t=g[e-1],e=g[e];var t,a=a-t.date>e.date-a?e:t,e=a.date.toLocaleString(void 0,m)+"\n"+d3.format(",")(a.value);l.attr("transform","translate("+r(a.date)+","+n(a.value)+")").call(v,e,r(a.date),a.event),a.event?(w("#label-date").text(a.date.toLocaleString(void 0,m)),w("#label-name").text(a.event),w("#linechart-label").css("opacity",1),w("#linechart-label").css("max-height","10rem")):(w("#linechart-label").css("opacity",0),w("#linechart-label").css("max-height","2rem"))}).on("touchend mouseleave",function(){l.call(v,null)}))}()}w(".d3-linechart").each(function(){t(this.id)})});
//# sourceMappingURL=maps/datavis.min.js.map
